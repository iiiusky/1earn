# 硬件设备安全

---

## 免责声明

`本文档仅供学习和研究使用,请勿使用文中的技术源码用于非法用途,任何人造成的任何负面影响,与本人无关.`

---

**硬件产品默认口令**
- [硬件产品默认口令](http://www.r4v3zn.com/spear-framework/#/default-pwd/hardware-products)

---

# CPU

**Meltdown/Spectre**
- 文章
    - [An Explanation of the Meltdown/Spectre Bugs for a Non-Technical Audience](https://blog.cloudflare.com/meltdown-spectre-non-technical/)
    - [简单谈谈近期的 Intel 处理器漏洞](https://bbs.kafan.cn/thread-2112818-1-1.html)

- POC | Payload | exp
    - [speed47/spectre-meltdown-checker](https://github.com/speed47/spectre-meltdown-checker)
    - [Eugnis/spectre-attack](https://github.com/Eugnis/spectre-attack)
    - [turbo/KPTI-PoC-Collection](https://github.com/turbo/KPTI-PoC-Collection)

---

# Camera

**RTSP 未授权访问漏洞**
- 华为 : `rtsp://admin:HuaWei123@IP/LiveMedia/ch1/Media1`
- 海康威视 主码流 : `rtsp://admin:12345@IP:554/h264/ch1/main/av_stream`
- 海康威视 主码流 : `rtsp://admin:12345@IP:554/MPEG-4/ch1/main/av_stream`
- 海康威视 主码流 : `rtsp://admin:12345@IP:554/h264/ch1/main/av_stream`
- 海康威视 子码流 : `rtsp://admin:12345@IP/mpeg4/ch1/sub/av_stream`
- 海康威视 子码流 : `rtsp://admin:12345@IP/h264/ch1/sub/av_stream`
- 宇视 主码流 : `rtsp://admin:admin@IP:554/video1`
- 宇视 子码流 : `rtsp://admin:admin@IP:554/video2`
- 宇视 三码流 : `rtsp://admin:admin@IP:554/video3`

**海康威视**
- **工具**
    - [4n4nk3/HikPwn](https://github.com/4n4nk3/HikPwn)

---

# Printer

**文章**
- [How to make 60,000 printers print whatever you want](https://kur0sec.org/print)
- [An Introduction to Printer Exploitation](https://0x00sec.org/t/an-introduction-to-printer-exploitation/3565)
- [Researching The FAX Machine Attack Surface | X41 D-SEC GmbH](https://www.x41-dsec.de/lab/blog/fax/)
- [一个传真接管你的网络：含有传真功能的打印机漏洞分析](https://xz.aliyun.com/t/2573)
- [打印机PCL漏洞原理分析](https://www.cnblogs.com/anka9080/p/5235622.html)

**资源**
- [Hacking Printers](http://hacking-printers.net/wiki/index.php/Main_Page)

**工具**
- **PRET**
    ```bash
    # Installation
    git clone https://github.com/RUB-NDS/PRET.git
    cd PRET

    pip install colorama pysnmp

    # Usage
    python2 ./pret.py
    python2 ./pret.py xxx.xxx.xxx.xxx pjl
    python2 ./pret.py xxx.xxx.xxx.xxx ps
    python2 ./pret.py xxx.xxx.xxx.xxx pcl
    ```

---

# Router-Switch

**漏洞库**
- [Routerpwn - One click exploits, generators, tools, news, vulnerabilities, poc, alerts](http://routerpwn.com/)

**资源**
- [libc0607/Realtek_switch_hacking](https://github.com/libc0607/Realtek_switch_hacking)

**文章**
- [Assessing the security of a portable router: a look inside its hardware - Malwarebytes Labs | Malwarebytes Labs](https://blog.malwarebytes.com/security-world/technology/2018/09/security-portable-router-inside-hardware/)
- [RouterOS: Chain to Root](https://medium.com/tenable-techblog/routeros-chain-to-root-f4e0b07c0b21)
- [记一次移动光猫(GM219-S)安全测试](https://gh0st.cn/archives/2019-03-12/1)
- [Openwrt漏洞挖掘之小米路由](https://aq.mk/index.php/archives/openwrt.html)

**漏洞利用框架**
- **routersoloit**

    Installation
    ```bash
    git clone https://www.github.com/threat9/routersploit.git
    cd routersploit
    python3 -m pip install -r requirements.txt
    python3 rsf.py
    ```

    Usage
    ```bash
    use scanners/autopwn
    set target
    run
    ```

**CISCO**
- **CVE-2017-6736 Cisco IOS remote code execution**
    - 简介

        Cisco IOS 和 IOS XE 都是美国思科（Cisco）公司为其网络设备开发的操作系统。Simple Network Management Protocol（SNMP）subsystem 是其中的一个用于网络设备管理信息交换的简单网络管理子系统。

        Cisco IOS 12.0 版本至 12.4 版本、15.0 版本至 15.6 版本和 IOS XE 2.2 版本至 3.17 版本中的 SNMP 子系统中存在安全漏洞。远程攻击者可通过向受影响系统发送特制的 SNMP 数据包利用该漏洞在受影响的系统上执行任意代码或造成系统重启。以下版本受到影响：SNMP 1版本，2c版本，3版本。

    - 影响版本
        - Cisco:Ios:12.0(28a):::
        - Cisco:Ios:12.1(19)ec:::
        - Cisco:Ios:12.2(14)s13:::
        - Cisco:Ios:12.1(19)e7:::
        - Cisco:Ios:12.2(14)s12:::

    - POC | Payload | exp
        - [artkond/cisco-snmp-rce](https://github.com/artkond/cisco-snmp-rce)

**小米**
- **CVE-2019-18370**
    - 简介

        Xiaomi Mi WiFi R3G 是中国小米科技（Xiaomi）公司的一款 3G 路由器。

        Xiaomi Mi WiFi R3G 2.28.23-stable 之前版本中存在输入验证错误漏洞。该漏洞源于网络系统或产品未对输入的数据进行正确的验证。

    - 影响版本
        -  Mi:Millet_router_3g:-:*:*:*

    - POC | Payload | exp
        - [Xiaomi_Mi_WiFi_R3G_Vulnerability_POC](https://github.com/UltramanGaia/Xiaomi_Mi_WiFi_R3G_Vulnerability_POC)

- **CVE-2019-18371**
    - 简介

        Xiaomi Mi WiFi R3G 2.28.23-stable 之前版本中存在路径遍历漏洞。该漏洞源于网络系统或产品未能正确地过滤资源或文件路径中的特殊元素。攻击者可利用该漏洞访问受限目录之外的位置。

    - 影响版本
        -  Mi:Millet_router_3g:-:*:*:*

    - POC | Payload | exp
        - [Xiaomi_Mi_WiFi_R3G_Vulnerability_POC](https://github.com/UltramanGaia/Xiaomi_Mi_WiFi_R3G_Vulnerability_POC)

**OpenWrt**
- **CVE-2019-12272 OpenWrt 图形化管理界面 LuCI 命令注入**
    - 简介

        OpenWrt LuCI 是一款用于 OpenWrt（Linux 发行版）的图形化配置界面。

        OpenWrt LuCI 0.10 及之前版本中的 admin/status/realtime/bandwidth_status 和 admin/status/realtime/wireless_status 端点存在命令注入漏洞。该漏洞源于外部输入数据构造可执行命令过程中，网络系统或产品未正确过滤其中的特殊元素。攻击者可利用该漏洞执行非法命令。

    - 影响版本
        - Openwrt:Luci:0.10.0:::

    - 文章
        - [CVE-2019-12272 OpenWrt图形化管理界面LuCI命令注入分析](https://hachp1.github.io/posts/Web%E5%AE%89%E5%85%A8/20190710-lucirce.html)

    - POC | Payload | exp
        - [HACHp1/LuCI_RCE_exp](https://github.com/HACHp1/LuCI_RCE_exp)

**Netlink**
- **Netlink GPON Router 1.0.11 - Remote Code Execution**
    - 文章
        - [多款光纤路由器设备在野0-day漏洞简报](https://blog.netlab.360.com/multiple-fiber-routers-are-being-compromised-by-botnets-using-0-day/)

    - POC | Payload | exp
        - [Netlink GPON Router 1.0.11 - Remote Code Execution](https://www.exploit-db.com/exploits/48225)
